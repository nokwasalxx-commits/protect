#!/bin/bash
clear
echo "======================================="
echo " üîê INSTALL PROTECT11 - HIDE ADMIN API "
echo "    Only Admin User ID = 1 "
echo "======================================="
sleep 2

# Path file
TARGET_FILE="/var/www/pterodactyl/resources/views/layouts/admin.blade.php"

echo "üìå Memulai patch..."
sleep 1

cat << 'EOF' > $TARGET_FILE
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>{{ config('app.name', 'Pterodactyl') }} - @yield('title')</title>
        <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
        <meta name="_token" content="{{ csrf_token() }}">

        <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
        <link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
        <link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
        <link rel="manifest" href="/favicons/manifest.json">
        <link rel="mask-icon" href="/favicons/safari-pinned-tab.svg" color="#bc6e3c">
        <link rel="shortcut icon" href="/favicons/favicon.ico">
        <meta name="msapplication-config" content="/favicons/browserconfig.xml">
        <meta name="theme-color" content="#0e4688">

        @include('layouts.scripts')

        @section('scripts')
            {!! Theme::css('vendor/select2/select2.min.css?t={cache-version}') !!}
            {!! Theme::css('vendor/bootstrap/bootstrap.min.css?t={cache-version}') !!}
            {!! Theme::css('vendor/adminlte/admin.min.css?t={cache-version}') !!}
            {!! Theme::css('vendor/adminlte/colors/skin-blue.min.css?t={cache-version}') !!}
            {!! Theme::css('vendor/sweetalert/sweetalert.min.css?t={cache-version}') !!}
            {!! Theme::css('vendor/animate/animate.min.css?t={cache-version}') !!}
            {!! Theme::css('css/pterodactyl.css?t={cache-version}') !!}
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css">
        @show
    </head>

<body class="hold-transition skin-blue fixed sidebar-mini">
<div class="wrapper">
<aside class="main-sidebar">
<section class="sidebar">
<ul class="sidebar-menu">
<li class="header">BASIC ADMINISTRATION</li>
<li><a href="{{ route('admin.index') }}"><i class="fa fa-home"></i> <span>Overview</span></a></li>

{{-- Hanya user ID 1 yang bisa melihat Application API --}}
@if(Auth::user()->id == 1)
<li><a href="{{ route('admin.api.index')}}"><i class="fa fa-gamepad"></i> <span>Application API</span></a></li>
@endif
EOF

echo "‚öôÔ∏è APPLYING PERMISSION & CACHE..."
sleep 1

cd /var/www/pterodactyl
php artisan view:clear
php artisan cache:clear

echo ""
echo "======================================="
echo "   üîê PROTECT 12 INSTALLED SUCCESS"
echo "   Hidden Admin API for non ID 1 user"
echo "======================================="
